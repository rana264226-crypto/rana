<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kami Flex SIM Database</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
/* Animated gradient background */
body {
  background: linear-gradient(270deg, #7f5af0, #2cb67d, #00c6ff, #ff5f6d);
  background-size: 800% 800%;
  animation: gradientShift 15s ease infinite;
  font-family: sans-serif;
}
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Glow text */
.kami-title { text-shadow: 0px 0px 20px rgba(127,90,240,0.8), 0px 0px 40px rgba(44,182,125,0.8); }

/* Loading dots */
.loading-dots span { animation: blink 1.5s infinite; }
.loading-dots span:nth-child(2) { animation-delay: 0.3s; }
.loading-dots span:nth-child(3) { animation-delay: 0.6s; }
@keyframes blink { 0%,80%,100% {opacity:0;} 40%{opacity:1;} }

/* Circle spinner */
.spinner {
  border: 4px solid rgba(255, 255, 255, 0.3);
  border-top: 4px solid #ff5f6d;
  border-radius: 50%;
  width: 40px; height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 12px auto;
}
@keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }

/* Button spinner */
.btn-spinner {
  border: 4px solid rgba(255,255,255,0.3);
  border-top: 4px solid #fff;
  border-radius: 50%;
  width: 20px; height: 20px;
  animation: spin 1s linear infinite;
}

/* Error message */
#errorMsg { color:#ff6b6b; font-weight:bold; display:none; margin-bottom:8px; text-align:center; }
</style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="w-full max-w-md bg-white/10 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20 text-center relative">
  <h1 class="text-3xl kami-title font-extrabold text-white mb-6">ğŸ”‘ Login Key</h1>
  <input id="loginKey" type="text" placeholder="Enter your login key" 
         class="w-full px-4 py-3 rounded-lg border border-white/30 bg-white/20 text-white placeholder-gray-300 mb-2"/>
  <p id="loginError" class="text-red-400 font-semibold mb-4 hidden">âŒ Wrong Key!</p>
  <button id="loginBtn" 
          class="w-full flex items-center justify-center gap-2 px-5 py-3 rounded-lg bg-gradient-to-r from-purple-600 via-pink-500 to-red-500 hover:opacity-90 text-white font-semibold shadow-lg relative">
    <span id="loginText">Login</span>
    <div id="loginSpinner" class="btn-spinner hidden"></div>
  </button>
  <p class="mt-6 text-white">Join our Telegram channel for updates:</p>
  <a href="https://t.me/Kami_Flex2" target="_blank" 
     class="inline-block mt-2 px-6 py-3 rounded-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white font-bold shadow-lg transform transition hover:scale-105 hover:shadow-2xl">
    ğŸ”— Join Telegram
  </a>
</div>

<!-- MAIN SCREEN -->
<div id="mainScreen" class="hidden w-full max-w-3xl bg-white/10 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20">
  <h1 class="text-4xl kami-title font-extrabold text-center mb-8 text-white tracking-wider">
    âš¡ Kami Flex <br> SIM Database
  </h1>

  <!-- Input & Button -->
  <div class="flex gap-3 mb-6">
    <input id="phoneInput" type="text" placeholder="Enter phone number (03xxxxxxxxx)" 
           class="flex-1 px-4 py-3 rounded-lg border border-white/30 bg-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-400" />
    <button id="searchBtn" 
            class="px-5 py-3 rounded-lg bg-gradient-to-r from-purple-600 via-pink-500 to-red-500 hover:opacity-90 text-white font-semibold shadow-lg">
      ğŸ” Search
    </button>
  </div>

  <!-- Loading -->
  <div id="loadingArea" class="hidden text-center mt-6 text-white text-xl font-bold">
    <div class="spinner"></div>
    <p>Searching<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span></p>
  </div>

  <!-- Results -->
  <div id="resultArea" class="space-y-4 mt-6"></div>
</div>

<script>
const correctKey = "Kami123"; // Replace with your key
const loginScreen = document.getElementById("loginScreen");
const mainScreen = document.getElementById("mainScreen");
const loginKey = document.getElementById("loginKey");
const loginBtn = document.getElementById("loginBtn");
const loginText = document.getElementById("loginText");
const loginSpinner = document.getElementById("loginSpinner");
const loginError = document.getElementById("loginError");

// LOGIN LOGIC
loginBtn.addEventListener("click", () => {
  const key = loginKey.value.trim();
  if(!key){ 
    loginError.innerText = "âš ï¸ Please enter login key!";
    loginError.classList.remove("hidden");
    return; 
  }

  loginText.classList.add("opacity-0");
  loginSpinner.classList.remove("hidden");
  loginError.classList.add("hidden");

  setTimeout(() => {
    if(key === correctKey){
      loginScreen.classList.add("hidden");
      mainScreen.classList.remove("hidden");

      // âœ… Interstitial ad trigger only after login
      (function(s){
        s.dataset.zone='9939958';
        s.src='https://groleegni.net/vignette.min.js';
      })([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')));

    } else {
      loginError.innerText = "âŒ Wrong Key!";
      loginError.classList.remove("hidden");
    }
    loginText.classList.remove("opacity-0");
    loginSpinner.classList.add("hidden");
  }, 1200);
});

// SIM DATABASE LOGIC
const searchBtn = document.getElementById("searchBtn");
const phoneInput = document.getElementById("phoneInput");
const loadingArea = document.getElementById("loadingArea");
const resultArea = document.getElementById("resultArea");

searchBtn.addEventListener("click", async () => {
  const phone = phoneInput.value.trim();
  if (!phone) {
    alert("âš ï¸ Please enter a phone number!");
    return;
  }
  resultArea.innerHTML = "";
  loadingArea.classList.remove("hidden");

  try {
    const res = await fetch(`/api/search?phone=${phone}`);
    const data = await res.json();
    loadingArea.classList.add("hidden");

    if (data.records && data.records.length > 0) {
      data.records.forEach((record) => {
        const card = document.createElement("div");
        card.className = `p-6 rounded-xl shadow-2xl bg-gradient-to-r from-purple-500 via-blue-500 to-green-500 text-white border border-white/20`;
        card.innerHTML = `
          <p class="mb-1"><strong>ğŸ‘¤ Name:</strong> ${record.Name || "N/A"}</p>
          <p class="mb-1"><strong>ğŸ“± Mobile:</strong> ${record.Mobile || "N/A"}</p>
          <p class="mb-1"><strong>ğŸŒ Country:</strong> ${record.Country || "N/A"}</p>
          <p class="mb-1"><strong>ğŸ†” CNIC:</strong> ${record.CNIC || "N/A"}</p>
          <p class="mb-1"><strong>ğŸ  Address:</strong> ${record.Address || "N/A"}</p>`;
        resultArea.appendChild(card);
      });
    } else {
      resultArea.innerHTML = `<p class="text-red-300 font-semibold text-center">âŒ No record found.</p>`;
    }
  } catch (error) {
    loadingArea.classList.add("hidden");
    resultArea.innerHTML = `<p class="text-red-300 font-semibold text-center">âš ï¸ Error fetching data.</p>`;
  }
});
</script>
</body>
</html>
